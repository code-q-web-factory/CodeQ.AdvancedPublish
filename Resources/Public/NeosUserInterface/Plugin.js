(()=>{var F=Object.create;var g=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var k=(e,t)=>()=>(e&&(t=e(e=0)),t);var c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var H=(e,t,o,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of K(t))!j.call(e,s)&&s!==o&&g(e,s,{get:()=>t[s],enumerable:!(a=G(t,s))||a.enumerable});return e};var d=(e,t,o)=>(o=e!=null?F(U(e)):{},H(t||!e||!e.__esModule?g(o,"default",{value:e,enumerable:!0}):o,e));function r(e){return(...t)=>{if(window["@Neos:HostPluginAPI"]&&window["@Neos:HostPluginAPI"][`@${e}`])return window["@Neos:HostPluginAPI"][`@${e}`](...t);throw new Error("You are trying to read from a consumer api that hasn't been initialized yet!")}}var n=k(()=>{});var P=c((he,y)=>{n();y.exports=r("vendor")().ReactDOM});var O=c((be,x)=>{n();x.exports=r("vendor")().React});var C=c((ye,_)=>{n();_.exports=r("vendor")().reduxSagaEffects});var v=c((xe,E)=>{n();E.exports=r("NeosProjectPackages")().NeosUiReduxStore});var w=c((_e,D)=>{n();D.exports=r("vendor")().reduxActions});var L=c((ve,R)=>{n();R.exports=r("vendor")().reactRedux});n();var A=r("manifest");var W=d(P()),i=d(O()),f=d(C()),m=d(v());var u=d(w()),S={TOGGLE_ADVANCED_PUBLISH_DIALOG:"CodeQ.AdvancedPublish/TOGGLE_ADVANCED_PUBLISH_DIALOG"},V=(0,u.createAction)(S.TOGGLE_ADVANCED_PUBLISH_DIALOG),p={toggleAdvancedPublishDialog:V},I=(0,u.handleActions)({[S.TOGGLE_ADVANCED_PUBLISH_DIALOG]:(e,t)=>({...e,plugins:{...e.plugins,advancedPublishDialog:{open:t.payload!==void 0?t.payload.open:!e.plugins?.advancedPublishDialog?.open}}})},{plugins:{advancedPublishDialog:{open:!1}}}),N={advancedPublishDialogOpen:e=>e.plugins?.advancedPublishDialog?.open};var l=d(L()),T=({iframeUri:e})=>{let t=(0,l.useSelector)(N.advancedPublishDialogOpen),o=i.useRef(null),a=(0,l.useDispatch)(),s=i.useCallback(()=>{let h=o.current?.contentWindow;h&&(h.exit=()=>a(p.toggleAdvancedPublishDialog()))},[]);return t?i.createElement("iframe",{ref:o,onLoad:s,style:{width:"100%",height:"100%",position:"absolute",zIndex:"999999",top:"0",background:"#000",border:"0"},src:e}):""};A("CodeQ.AdvancedPublish",{},(e,{frontendConfiguration:t})=>{function*o(){yield(0,f.takeLatest)(m.actionTypes.CR.Workspaces.PUBLISH,function*(){let{payload:a}=yield(0,f.take)(m.actionTypes.ServerFeedback.HANDLE_SERVER_FEEDBACK);if(!a.feedbackEnvelope.feedbacks.some(s=>s.type==="Neos.Neos.Ui:Success")){console.warn("CodeQ.AdvancedPublish :: Publishing doesnt seem to have been successful. Aborting.");return}yield(0,f.put)(p.toggleAdvancedPublishDialog())})}e.get("containers").set("Modals/CodeQ.AdvancedPublish",()=>W.createPortal(i.createElement(T,{iframeUri:t["CodeQ.AdvancedPublish"].iframeUri}),document.body)),e.get("sagas").set("CodeQ.AdvancedPublish/afterPublish",{saga:o}),e.get("reducers").set("CodeQ.AdvancedPublish",{reducer:I})});})();
//# sourceMappingURL=Plugin.js.map

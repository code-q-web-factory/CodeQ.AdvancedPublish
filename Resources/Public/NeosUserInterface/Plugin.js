(()=>{var F=Object.create;var h=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var k=(e,t)=>()=>(e&&(t=e(e=0)),t);var c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var H=(e,t,o,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of K(t))!j.call(e,s)&&s!==o&&h(e,s,{get:()=>t[s],enumerable:!(a=G(t,s))||a.enumerable});return e};var d=(e,t,o)=>(o=e!=null?F(U(e)):{},H(t||!e||!e.__esModule?h(o,"default",{value:e,enumerable:!0}):o,e));function r(e){return(...t)=>{if(window["@Neos:HostPluginAPI"]&&window["@Neos:HostPluginAPI"][`@${e}`])return window["@Neos:HostPluginAPI"][`@${e}`](...t);throw new Error("You are trying to read from a consumer api that hasn't been initialized yet!")}}var n=k(()=>{});var y=c((ge,A)=>{n();A.exports=r("vendor")().ReactDOM});var O=c((Ae,P)=>{n();P.exports=r("vendor")().React});var w=c((Pe,_)=>{n();_.exports=r("vendor")().reduxSagaEffects});var E=c((_e,x)=>{n();x.exports=r("NeosProjectPackages")().NeosUiReduxStore});var C=c((xe,v)=>{n();v.exports=r("vendor")().reduxActions});var R=c((Ce,N)=>{n();N.exports=r("vendor")().reactRedux});n();var b=r("manifest");var L=d(y()),i=d(O()),f=d(w()),m=d(E());var u=d(C()),D={TOGGLE_ADVANCED_PUBLISH_DIALOG:"CodeQ.AdvancedPublish/TOGGLE_ADVANCED_PUBLISH_DIALOG"},V=(0,u.createAction)(D.TOGGLE_ADVANCED_PUBLISH_DIALOG),p={toggleAdvancedPublishDialog:V},S=(0,u.handleActions)({[D.TOGGLE_ADVANCED_PUBLISH_DIALOG]:(e,t)=>({...e,plugins:{...e.plugins,advancedPublishDialog:{open:t.payload!==void 0?t.payload.open:!e.plugins?.advancedPublishDialog?.open}}})},{plugins:{advancedPublishDialog:{open:!1}}}),I={advancedPublishDialogOpen:e=>e.plugins?.advancedPublishDialog?.open};var l=d(R()),T=({iframeUri:e})=>{let t=(0,l.useSelector)(I.advancedPublishDialogOpen),o=i.useRef(null),a=(0,l.useDispatch)(),s=i.useCallback(()=>{o.current?.contentWindow&&window.addEventListener("message",W=>{W.data==="closePublicationPopup"&&a(p.toggleAdvancedPublishDialog({open:!1}))})},[]);return t?i.createElement("iframe",{ref:o,onLoad:s,style:{width:"100%",height:"100%",position:"absolute",zIndex:"999999",top:"0",background:"#000",border:"0"},src:e}):""};b("CodeQ.AdvancedPublish",{},(e,{frontendConfiguration:t})=>{function*o(){yield(0,f.takeLatest)(m.actionTypes.CR.Workspaces.PUBLISH,function*(){let{payload:a}=yield(0,f.take)(m.actionTypes.ServerFeedback.HANDLE_SERVER_FEEDBACK);if(!a.feedbackEnvelope.feedbacks.some(s=>s.type==="Neos.Neos.Ui:Success")){console.warn("CodeQ.AdvancedPublish :: Publishing doesnt seem to have been successful. Aborting.");return}yield(0,f.put)(p.toggleAdvancedPublishDialog())})}e.get("containers").set("Modals/CodeQ.AdvancedPublish",()=>L.createPortal(i.createElement(T,{iframeUri:t["CodeQ.AdvancedPublish"].iframeUri}),document.body)),e.get("sagas").set("CodeQ.AdvancedPublish/afterPublish",{saga:o}),e.get("reducers").set("CodeQ.AdvancedPublish",{reducer:S})});})();
//# sourceMappingURL=Plugin.js.map
